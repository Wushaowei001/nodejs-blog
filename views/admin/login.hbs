<h1>登录</h1>
<form action="/admin/login" method="POST">
    <div class="form-group">
        <input id="un" type="text" name="username" placeholder="用户名">
    </div>
    <div class="form-group">
        <input id="pass" type="password" name="password" placeholder="密码">
    </div>
    <p id="tip" style="display: none;"></p>
    <input id="login" type="submit" class="btn" value="登录">
</form>
<script src="/javascripts/jquery.js"></script>
<script>
$(function() {
    var $un = $('#un'),
        $pass = $('#pass'),
        $tip = $('#tip');

    $('#login').on('click', function(event) {
        event.preventDefault();
        var $this = $(this);
        var un = $un.val().trim(),
            pass = $pass.val().trim();
        if (!un || !pass) {
            $tip.text('用户名或密码不能为空').show();
        }
        $tip.hide();
        $this.prop('disabled', true);
        $.ajax({
            url: '/admin/login',
            type: 'POST',
            dataType: 'json',
            beforeSend: function(req) {
                req.setRequestHeader('username', un);
                req.setRequestHeader('password', pass);
            }
        }).done(function(data) {
            if (!data.state) {
                $this.prop('disabled', false);
                $tip.text('用户名或密码错误').show();
                return;
            }
            window.location.href = '/admin/';
        }).error(function() {
            $this.prop('disabled', false);
        });
    });
});
</script>
